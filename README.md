Изначально задумывалось, что изображения будут динамически подгружаться пакетами с яндекс диска, а вычисления должны были проводиться в гугл коллабе. Но в последствии выяснилось, что надёжнее (в плане вылетов) и быстрее всё делать у себя на компьютере. Тут же я обнаружил, что на самом деле OpenCV выдавал ошибку о нечитаемых файлах, потому что те были либо .psd, либо весили 0b на диске. Ну и уже не стал перезапускать все вычисления, удалил не читаемые файлы и пошёл дальше. Так же, по идее, покеты должны были динамически отгружать на яндекс диск, и они отгружались, когда вычисления были в коллабе, но у себя на пк в этом уже не было необходимости.

https://disk.yandex.ru/d/L8SmEplUzZMJpg
ссылка на превью, как работает выделение и обрезание фона

Также в процессе вычислений выяснилось, что иногда Segment-Anything выделяет фон на отдельный слой, и тогда можно просто вырезать слой, у которого самый большой периметр, а иногда не выделяет. Так что уже у себя на ПК я перезапустил все вычсиления с нуля (не смотря на то, что 1500 изображений уже были обработаны в коллабе), с новой функцией выбора слоя для вырезания. В ноутбуке лежат функции для работы с API яндекс диска, которые я использовал, так как у меня очень много маленьких файликов (я отгружаю на диск маски), то я увеличил число одновременно отправляемых изображений.